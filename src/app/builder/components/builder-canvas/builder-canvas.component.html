<!-- src/app/builder/components/builder-canvas/builder-canvas.component.html - COMPLETE -->

<div class="builder-canvas-wrapper">
  <!-- Canvas Toolbar -->
  <div class="canvas-toolbar">
    <div class="toolbar-group">
      <button mat-icon-button (click)="toggleGrid()" [class.active]="showGrid" matTooltip="Toggle Grid">
        <mat-icon>grid_on</mat-icon>
      </button>
      <button mat-icon-button (click)="toggleOutlines()" [class.active]="showOutlines" matTooltip="Toggle Outlines">
        <mat-icon>border_all</mat-icon>
      </button>
    </div>

    <div class="toolbar-group">
      <button mat-icon-button (click)="setDeviceFrame('none')" [class.active]="deviceFrame === 'none'" matTooltip="No Frame">
        <mat-icon>fullscreen</mat-icon>
      </button>
      <button mat-icon-button (click)="setDeviceFrame('phone')" [class.active]="deviceFrame === 'phone'" matTooltip="Phone Frame">
        <mat-icon>smartphone</mat-icon>
      </button>
      <button mat-icon-button (click)="setDeviceFrame('tablet')" [class.active]="deviceFrame === 'tablet'" matTooltip="Tablet Frame">
        <mat-icon>tablet_mac</mat-icon>
      </button>
    </div>

    <div class="toolbar-group zoom-controls">
      <button mat-icon-button (click)="zoomOut()" matTooltip="Zoom Out">
        <mat-icon>zoom_out</mat-icon>
      </button>
      <span class="zoom-level">{{ (canvasScale * 100).toFixed(0) }}%</span>
      <button mat-icon-button (click)="zoomIn()" matTooltip="Zoom In">
        <mat-icon>zoom_in</mat-icon>
      </button>
      <button mat-icon-button (click)="resetZoom()" matTooltip="Reset Zoom">
        <mat-icon>zoom_out_map</mat-icon>
      </button>
    </div>
  </div>

  <!-- Canvas Area -->
  <div class="builder-canvas"
       [class.show-grid]="showGrid"
       [class.show-outlines]="showOutlines"
       (click)="onCanvasClick($event)">

    <div class="canvas-viewport"
         [class.device-phone]="deviceFrame === 'phone'"
         [class.device-tablet]="deviceFrame === 'tablet'"
         [style.transform]="'scale(' + canvasScale + ')'"
         cdkDropList
         [cdkDropListData]="{path: []}"
         (cdkDropListDropped)="onDrop($event)"
         (cdkDropListEntered)="onDragEnter($event, [])"
         (cdkDropListExited)="onDragExit($event)">

      <!-- Canvas Content -->
      <div class="canvas-content">
        <ng-container *ngIf="uiStructure">
          <div class="canvas-root">
            <ng-container
              [ngTemplateOutlet]="widgetRenderer"
              [ngTemplateOutletContext]="{component: uiStructure, path: []}">
            </ng-container>
          </div>
        </ng-container>

        <!-- Empty State -->
        <div class="empty-canvas" *ngIf="!uiStructure || (!uiStructure.children?.length && uiStructure.type === 'container')">
          <div class="empty-content">
            <mat-icon class="empty-icon">widgets</mat-icon>
            <h3>Start Building Your App</h3>
            <p>Drag widgets from the toolbox to begin designing your screen</p>
          </div>
        </div>
      </div>

      <!-- Drop Zone Overlay -->
      <div class="drop-overlay"
           *ngIf="draggedElement && activeDropZone?.isActive"
           [class.can-drop]="activeDropZone?.canDrop"
           [class.cannot-drop]="!activeDropZone?.canDrop">
        <div class="drop-indicator">
          <mat-icon>{{ activeDropZone?.canDrop ? 'add' : 'block' }}</mat-icon>
          <span>{{ activeDropZone?.canDrop ? 'Drop widget here' : 'Cannot drop here' }}</span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Universal Widget Renderer Template -->
<ng-template #widgetRenderer let-component="component" let-path="path">
  <div
    class="widget-wrapper"
    [attr.data-widget-type]="component.type"
    [ngClass]="{
      'selected': isElementSelected(path),
      'hovered': isElementHovered(path),
      'drop-target': isDropTarget(path),
      'can-drop': canDropAtPath(path),
      'is-container': canAcceptChildren(component)
    }"
    [ngStyle]="getElementStyles(component)"
    (click)="onElementClick(component, path, $event)"
    (mouseenter)="onElementMouseEnter(path)"
    (mouseleave)="onElementMouseLeave()"
    cdkDrag
    [cdkDragData]="{component: component, path: path}"
    [cdkDragDisabled]="path.length === 0">

    <!-- Widget Controls (visible when selected) -->
    <div class="widget-controls" *ngIf="isElementSelected(path) && path.length > 0">
      <div class="widget-label">
        <mat-icon class="widget-type-icon">{{ getElementIcon(component) }}</mat-icon>
        <span>{{ getElementDisplayName(component) }}</span>
      </div>
      <div class="widget-actions">
        <button mat-icon-button size="small" (click)="onCopyElement(path, $event)" matTooltip="Copy">
          <mat-icon>content_copy</mat-icon>
        </button>
        <button mat-icon-button size="small" (click)="onDuplicateElement(path, $event)" matTooltip="Duplicate">
          <mat-icon>control_point_duplicate</mat-icon>
        </button>
        <button mat-icon-button size="small" (click)="onDeleteElement(path, $event)" matTooltip="Delete" class="delete-btn">
          <mat-icon>delete</mat-icon>
        </button>
      </div>
    </div>

    <!-- Widget Content Based on Type -->
    <div class="widget-content" [ngSwitch]="component.type.toLowerCase()">

      <!-- LAYOUT WIDGETS -->

      <!-- Scaffold -->
      <div *ngSwitchCase="'scaffold'" class="widget-scaffold">
        <div class="scaffold-appbar" *ngIf="component.properties?.showAppBar !== false"
             [style.background-color]="component.properties?.appBarColor || '#2196F3'">
          <mat-icon>menu</mat-icon>
          <span>{{ component.properties?.title || 'App Bar' }}</span>
          <div class="appbar-spacer"></div>
          <mat-icon>more_vert</mat-icon>
        </div>
        <div class="scaffold-body"
             [style.background-color]="component.properties?.backgroundColor"
             cdkDropList
             [cdkDropListData]="{path: path}"
             (cdkDropListDropped)="onDrop($event, path)"
             (cdkDropListEntered)="onDragEnter($event, path)"
             (cdkDropListExited)="onDragExit($event)">
          <ng-container *ngFor="let child of component.children; let i = index; trackBy: trackChild">
            <ng-container
              [ngTemplateOutlet]="widgetRenderer"
              [ngTemplateOutletContext]="{component: child, path: path.concat([i])}">
            </ng-container>
          </ng-container>
          <div class="empty-container" *ngIf="!component.children?.length">
            <mat-icon>web</mat-icon>
            <span>Scaffold Body</span>
          </div>
        </div>
      </div>

      <!-- Container -->
      <div *ngSwitchCase="'container'" class="widget-container"
           cdkDropList
           [cdkDropListData]="{path: path}"
           (cdkDropListDropped)="onDrop($event, path)"
           (cdkDropListEntered)="onDragEnter($event, path)"
           (cdkDropListExited)="onDragExit($event)">
        <ng-container *ngFor="let child of component.children; let i = index; trackBy: trackChild">
          <ng-container
            [ngTemplateOutlet]="widgetRenderer"
            [ngTemplateOutletContext]="{component: child, path: path.concat([i])}">
          </ng-container>
        </ng-container>
        <div class="empty-container" *ngIf="!component.children?.length">
          <mat-icon>crop_free</mat-icon>
          <span>Container</span>
        </div>
      </div>

      <!-- Column -->
      <div *ngSwitchCase="'column'" class="widget-column"
           cdkDropList
           [cdkDropListData]="{path: path}"
           (cdkDropListDropped)="onDrop($event, path)"
           (cdkDropListEntered)="onDragEnter($event, path)"
           (cdkDropListExited)="onDragExit($event)">
        <ng-container *ngFor="let child of component.children; let i = index; trackBy: trackChild">
          <ng-container
            [ngTemplateOutlet]="widgetRenderer"
            [ngTemplateOutletContext]="{component: child, path: path.concat([i])}">
          </ng-container>
        </ng-container>
        <div class="empty-container" *ngIf="!component.children?.length">
          <mat-icon>view_column</mat-icon>
          <span>Column</span>
        </div>
      </div>

      <!-- Row -->
      <div *ngSwitchCase="'row'" class="widget-row"
           cdkDropList
           cdkDropListOrientation="horizontal"
           [cdkDropListData]="{path: path}"
           (cdkDropListDropped)="onDrop($event, path)"
           (cdkDropListEntered)="onDragEnter($event, path)"
           (cdkDropListExited)="onDragExit($event)">
        <ng-container *ngFor="let child of component.children; let i = index; trackBy: trackChild">
          <ng-container
            [ngTemplateOutlet]="widgetRenderer"
            [ngTemplateOutletContext]="{component: child, path: path.concat([i])}">
          </ng-container>
        </ng-container>
        <div class="empty-container" *ngIf="!component.children?.length">
          <mat-icon>view_stream</mat-icon>
          <span>Row</span>
        </div>
      </div>

      <!-- Stack -->
      <div *ngSwitchCase="'stack'" class="widget-stack"
           cdkDropList
           [cdkDropListData]="{path: path}"
           (cdkDropListDropped)="onDrop($event, path)"
           (cdkDropListEntered)="onDragEnter($event, path)"
           (cdkDropListExited)="onDragExit($event)">
        <ng-container *ngFor="let child of component.children; let i = index; trackBy: trackChild">
          <div class="stack-child" [style.z-index]="i">
            <ng-container
              [ngTemplateOutlet]="widgetRenderer"
              [ngTemplateOutletContext]="{component: child, path: path.concat([i])}">
            </ng-container>
          </div>
        </ng-container>
        <div class="empty-container" *ngIf="!component.children?.length">
          <mat-icon>layers</mat-icon>
          <span>Stack</span>
        </div>
      </div>

      <!-- Center -->
      <div *ngSwitchCase="'center'" class="widget-center"
           cdkDropList
           [cdkDropListData]="{path: path}"
           (cdkDropListDropped)="onDrop($event, path)"
           (cdkDropListEntered)="onDragEnter($event, path)"
           (cdkDropListExited)="onDragExit($event)">
        <ng-container *ngFor="let child of component.children; let i = index; trackBy: trackChild">
          <ng-container
            [ngTemplateOutlet]="widgetRenderer"
            [ngTemplateOutletContext]="{component: child, path: path.concat([i])}">
          </ng-container>
        </ng-container>
        <div class="empty-container" *ngIf="!component.children?.length">
          <mat-icon>center_focus_weak</mat-icon>
          <span>Center</span>
        </div>
      </div>

      <!-- Padding -->
      <div *ngSwitchCase="'padding'" class="widget-padding"
           cdkDropList
           [cdkDropListData]="{path: path}"
           (cdkDropListDropped)="onDrop($event, path)"
           (cdkDropListEntered)="onDragEnter($event, path)"
           (cdkDropListExited)="onDragExit($event)">
        <ng-container *ngFor="let child of component.children; let i = index; trackBy: trackChild">
          <ng-container
            [ngTemplateOutlet]="widgetRenderer"
            [ngTemplateOutletContext]="{component: child, path: path.concat([i])}">
          </ng-container>
        </ng-container>
        <div class="empty-container" *ngIf="!component.children?.length">
          <mat-icon>space_bar</mat-icon>
          <span>Padding</span>
        </div>
      </div>

      <!-- Card -->
      <div *ngSwitchCase="'card'" class="widget-card mat-elevation-z"
           [class.mat-elevation-z1]="(component.properties?.elevation || 2) === 1"
           [class.mat-elevation-z2]="(component.properties?.elevation || 2) === 2"
           [class.mat-elevation-z3]="(component.properties?.elevation || 2) === 3"
           [class.mat-elevation-z4]="(component.properties?.elevation || 2) === 4"
           [class.mat-elevation-z8]="(component.properties?.elevation || 2) >= 8"
           cdkDropList
           [cdkDropListData]="{path: path}"
           (cdkDropListDropped)="onDrop($event, path)"
           (cdkDropListEntered)="onDragEnter($event, path)"
           (cdkDropListExited)="onDragExit($event)">
        <ng-container *ngFor="let child of component.children; let i = index; trackBy: trackChild">
          <ng-container
            [ngTemplateOutlet]="widgetRenderer"
            [ngTemplateOutletContext]="{component: child, path: path.concat([i])}">
          </ng-container>
        </ng-container>
        <div class="empty-container" *ngIf="!component.children?.length">
          <mat-icon>credit_card</mat-icon>
          <span>Card</span>
        </div>
      </div>

      <!-- ListView -->
      <div *ngSwitchCase="'listview'" class="widget-listview"
           cdkDropList
           [cdkDropListData]="{path: path}"
           (cdkDropListDropped)="onDrop($event, path)"
           (cdkDropListEntered)="onDragEnter($event, path)"
           (cdkDropListExited)="onDragExit($event)">
        <ng-container *ngFor="let child of component.children; let i = index; trackBy: trackChild">
          <div class="list-item">
            <ng-container
              [ngTemplateOutlet]="widgetRenderer"
              [ngTemplateOutletContext]="{component: child, path: path.concat([i])}">
            </ng-container>
          </div>
        </ng-container>
        <div class="empty-container" *ngIf="!component.children?.length">
          <mat-icon>list</mat-icon>
          <span>ListView</span>
        </div>
      </div>

      <!-- GridView -->
      <div *ngSwitchCase="'gridview'" class="widget-gridview"
           [style.grid-template-columns]="'repeat(' + (component.properties?.crossAxisCount || 2) + ', 1fr)'"
           [style.gap]="(component.properties?.crossAxisSpacing || 8) + 'px'"
           cdkDropList
           [cdkDropListData]="{path: path}"
           (cdkDropListDropped)="onDrop($event, path)"
           (cdkDropListEntered)="onDragEnter($event, path)"
           (cdkDropListExited)="onDragExit($event)">
        <ng-container *ngFor="let child of component.children; let i = index; trackBy: trackChild">
          <ng-container
            [ngTemplateOutlet]="widgetRenderer"
            [ngTemplateOutletContext]="{component: child, path: path.concat([i])}">
          </ng-container>
        </ng-container>
        <div class="empty-container" *ngIf="!component.children?.length">
          <mat-icon>grid_view</mat-icon>
          <span>GridView</span>
        </div>
      </div>

      <!-- Wrap -->
      <div *ngSwitchCase="'wrap'" class="widget-wrap"
           cdkDropList
           [cdkDropListData]="{path: path}"
           (cdkDropListDropped)="onDrop($event, path)"
           (cdkDropListEntered)="onDragEnter($event, path)"
           (cdkDropListExited)="onDragExit($event)">
        <ng-container *ngFor="let child of component.children; let i = index; trackBy: trackChild">
          <ng-container
            [ngTemplateOutlet]="widgetRenderer"
            [ngTemplateOutletContext]="{component: child, path: path.concat([i])}">
          </ng-container>
        </ng-container>
        <div class="empty-container" *ngIf="!component.children?.length">
          <mat-icon>wrap_text</mat-icon>
          <span>Wrap</span>
        </div>
      </div>

      <!-- Expanded -->
      <div *ngSwitchCase="'expanded'" class="widget-expanded"
           [style.flex]="component.properties?.flex || 1"
           cdkDropList
           [cdkDropListData]="{path: path}"
           (cdkDropListDropped)="onDrop($event, path)"
           (cdkDropListEntered)="onDragEnter($event, path)"
           (cdkDropListExited)="onDragExit($event)">
        <ng-container *ngFor="let child of component.children; let i = index; trackBy: trackChild">
          <ng-container
            [ngTemplateOutlet]="widgetRenderer"
            [ngTemplateOutletContext]="{component: child, path: path.concat([i])}">
          </ng-container>
        </ng-container>
        <div class="empty-container" *ngIf="!component.children?.length">
          <mat-icon>open_in_full</mat-icon>
          <span>Expanded</span>
        </div>
      </div>

      <!-- Flexible -->
      <div *ngSwitchCase="'flexible'" class="widget-flexible"
           [style.flex]="component.properties?.flex || 1"
           cdkDropList
           [cdkDropListData]="{path: path}"
           (cdkDropListDropped)="onDrop($event, path)"
           (cdkDropListEntered)="onDragEnter($event, path)"
           (cdkDropListExited)="onDragExit($event)">
        <ng-container *ngFor="let child of component.children; let i = index; trackBy: trackChild">
          <ng-container
            [ngTemplateOutlet]="widgetRenderer"
            [ngTemplateOutletContext]="{component: child, path: path.concat([i])}">
          </ng-container>
        </ng-container>
        <div class="empty-container" *ngIf="!component.children?.length">
          <mat-icon>fit_screen</mat-icon>
          <span>Flexible</span>
        </div>
      </div>

      <!-- SizedBox -->
      <div *ngSwitchCase="'sizedbox'" class="widget-sizedbox"
           cdkDropList
           [cdkDropListData]="{path: path}"
           (cdkDropListDropped)="onDrop($event, path)"
           (cdkDropListEntered)="onDragEnter($event, path)"
           (cdkDropListExited)="onDragExit($event)">
        <ng-container *ngFor="let child of component.children; let i = index; trackBy: trackChild">
          <ng-container
            [ngTemplateOutlet]="widgetRenderer"
            [ngTemplateOutletContext]="{component: child, path: path.concat([i])}">
          </ng-container>
        </ng-container>
        <div class="empty-container" *ngIf="!component.children?.length">
          <mat-icon>crop_din</mat-icon>
          <span>SizedBox</span>
        </div>
      </div>

      <!-- DISPLAY WIDGETS -->

      <!-- Text -->
      <div *ngSwitchCase="'text'" class="widget-text"
           [style.font-size]="(component.properties?.fontSize || 16) + 'px'"
           [style.color]="component.properties?.color || '#000000'"
           [style.text-align]="component.properties?.textAlign || 'left'"
           [style.font-weight]="component.properties?.fontWeight || 'normal'"
           [style.font-style]="component.properties?.fontStyle || 'normal'"
           [style.text-decoration]="component.properties?.textDecoration || 'none'"
           [style.line-height]="component.properties?.lineHeight">
        {{ getTextContent(component) }}
      </div>

      <!-- Icon -->
      <mat-icon *ngSwitchCase="'icon'" class="widget-icon"
                [style.font-size]="(component.properties?.size || 24) + 'px'"
                [style.width]="(component.properties?.size || 24) + 'px'"
                [style.height]="(component.properties?.size || 24) + 'px'"
                [style.color]="component.properties?.color || '#000000'">
        {{ getIconName(component) }}
      </mat-icon>

      <!-- Image -->
      <div *ngSwitchCase="'image'" class="widget-image">
        <img [src]="component.properties?.source || 'assets/placeholder.png'"
             [alt]="component.properties?.alt || 'Image'"
             [style.width]="component.properties?.width ? (component.properties.width + 'px') : '100%'"
             [style.height]="component.properties?.height ? (component.properties.height + 'px') : 'auto'"
             [style.object-fit]="component.properties?.fit || 'cover'">
      </div>

      <!-- Divider -->
      <div *ngSwitchCase="'divider'" class="widget-divider"
           [style.height]="(component.properties?.thickness || 1) + 'px'"
           [style.background-color]="component.properties?.color || '#E0E0E0'"
           [style.margin-left]="(component.properties?.indent || 0) + 'px'"
           [style.margin-right]="(component.properties?.endIndent || 0) + 'px'">
      </div>

      <!-- CircularProgressIndicator -->
      <div *ngSwitchCase="'circularprogressindicator'" class="widget-progress">
        <div class="circular-progress"
             [style.width]="'40px'"
             [style.height]="'40px'"
             [style.border-color]="component.properties?.color || '#2196F3'">
        </div>
      </div>

      <!-- INPUT WIDGETS -->

      <!-- TextField -->
      <div *ngSwitchCase="'textfield'" class="widget-textfield">
        <input type="text"
               class="mock-textfield"
               [placeholder]="component.properties?.hintText || 'Enter text'"
               [value]="component.properties?.text || ''"
               [disabled]="!component.properties?.enabled"
               readonly>
        <label class="textfield-label" *ngIf="component.properties?.labelText">
          {{ component.properties.labelText }}
        </label>
      </div>

      <!-- Checkbox -->
      <div *ngSwitchCase="'checkbox'" class="widget-checkbox">
        <input type="checkbox"
               [checked]="component.properties?.value"
               [disabled]="!component.properties?.enabled"
               readonly>
        <span>{{ component.properties?.label || 'Checkbox' }}</span>
      </div>

      <!-- Switch -->
      <div *ngSwitchCase="'switch'" class="widget-switch">
        <label class="switch">
          <input type="checkbox"
                 [checked]="component.properties?.value"
                 [disabled]="!component.properties?.enabled"
                 readonly>
          <span class="switch-slider"
                [style.background-color]="component.properties?.value ? (component.properties?.activeColor || '#2196F3') : (component.properties?.inactiveTrackColor || '#9E9E9E')">
          </span>
        </label>
        <span>{{ component.properties?.label || 'Switch' }}</span>
      </div>

      <!-- Radio -->
      <div *ngSwitchCase="'radio'" class="widget-radio">
        <input type="radio"
               [checked]="component.properties?.value"
               [disabled]="!component.properties?.enabled"
               readonly>
        <span>{{ component.properties?.label || 'Radio' }}</span>
      </div>

      <!-- Slider -->
      <div *ngSwitchCase="'slider'" class="widget-slider">
        <input type="range"
               class="mock-slider"
               [min]="component.properties?.min || 0"
               [max]="component.properties?.max || 100"
               [value]="component.properties?.value || 50"
               [disabled]="!component.properties?.enabled"
               readonly>
        <span class="slider-label" *ngIf="component.properties?.label">
          {{ component.properties.label }}
        </span>
      </div>

      <!-- BUTTON WIDGETS -->

      <!-- ElevatedButton -->
      <button *ngSwitchCase="'elevatedbutton'" class="widget-button elevated-button"
              [style.background-color]="component.properties?.backgroundColor || '#2196F3'"
              [style.color]="component.properties?.foregroundColor || '#FFFFFF'"
              [disabled]="!component.properties?.enabled">
        <mat-icon *ngIf="component.properties?.icon">{{ component.properties.icon }}</mat-icon>
        {{ component.properties?.text || 'Elevated Button' }}
      </button>

      <!-- TextButton -->
      <button *ngSwitchCase="'textbutton'" class="widget-button text-button"
              [style.color]="component.properties?.foregroundColor || '#2196F3'"
              [disabled]="!component.properties?.enabled">
        <mat-icon *ngIf="component.properties?.icon">{{ component.properties.icon }}</mat-icon>
        {{ component.properties?.text || 'Text Button' }}
      </button>

      <!-- OutlinedButton -->
      <button *ngSwitchCase="'outlinedbutton'" class="widget-button outlined-button"
              [style.color]="component.properties?.foregroundColor || '#2196F3'"
              [style.border-color]="component.properties?.borderColor || '#2196F3'"
              [style.border-width]="(component.properties?.borderWidth || 1) + 'px'"
              [disabled]="!component.properties?.enabled">
        <mat-icon *ngIf="component.properties?.icon">{{ component.properties.icon }}</mat-icon>
        {{ component.properties?.text || 'Outlined Button' }}
      </button>

      <!-- IconButton -->
      <button *ngSwitchCase="'iconbutton'" class="widget-button icon-button"
              [style.color]="component.properties?.color || '#2196F3'"
              [disabled]="!component.properties?.enabled">
        <mat-icon [style.font-size]="(component.properties?.iconSize || 24) + 'px'">
          {{ component.properties?.icon || 'favorite' }}
        </mat-icon>
      </button>

      <!-- FloatingActionButton -->
      <button *ngSwitchCase="'floatingactionbutton'" class="widget-button fab-button"
              [class.mini]="component.properties?.mini"
              [style.background-color]="component.properties?.backgroundColor || '#2196F3'"
              [style.color]="component.properties?.foregroundColor || '#FFFFFF'"
              [disabled]="!component.properties?.enabled">
        <mat-icon>{{ component.properties?.icon || 'add' }}</mat-icon>
        <span *ngIf="component.properties?.extended" class="fab-label">
          {{ component.properties?.label || 'FAB' }}
        </span>
      </button>

      <!-- NAVIGATION WIDGETS -->

      <!-- AppBar -->
      <div *ngSwitchCase="'appbar'" class="widget-appbar"
           [style.background-color]="component.properties?.backgroundColor || '#2196F3'"
           [style.color]="component.properties?.foregroundColor || '#FFFFFF'">
        <mat-icon *ngIf="component.properties?.showLeading !== false">
          {{ component.properties?.leadingIcon || 'menu' }}
        </mat-icon>
        <span class="appbar-title" [style.text-align]="component.properties?.centerTitle ? 'center' : 'left'">
          {{ component.properties?.title || 'App Bar' }}
        </span>
        <div class="appbar-spacer"></div>
        <div class="appbar-actions">
          <mat-icon>search</mat-icon>
          <mat-icon>more_vert</mat-icon>
        </div>
      </div>

      <!-- BottomNavigationBar -->
      <div *ngSwitchCase="'bottomnavigationbar'" class="widget-bottom-nav"
           [style.background-color]="component.properties?.backgroundColor || '#FFFFFF'">
        <div class="nav-item"
             *ngFor="let item of (component.properties?.items || [{icon: 'home', label: 'Home'}, {icon: 'search', label: 'Search'}, {icon: 'person', label: 'Profile'}]); let i = index"
             [class.selected]="i === component.properties?.currentIndex"
             [style.color]="i === component.properties?.currentIndex ? (component.properties?.selectedItemColor || '#2196F3') : (component.properties?.unselectedItemColor || '#757575')">
          <mat-icon>{{ item.icon }}</mat-icon>
          <span>{{ item.label }}</span>
        </div>
      </div>

      <!-- ListTile -->
      <div *ngSwitchCase="'listtile'" class="widget-listtile"
           [class.selected]="component.properties?.selected"
           [style.background-color]="component.properties?.selected ? (component.properties?.selectedTileColor || '#E3F2FD') : 'transparent'">
        <mat-icon class="listtile-leading" *ngIf="component.properties?.leadingIcon">
          {{ component.properties.leadingIcon }}
        </mat-icon>
        <div class="listtile-text">
          <div class="listtile-title">{{ component.properties?.title || 'List Item' }}</div>
          <div class="listtile-subtitle" *ngIf="component.properties?.subtitle">
            {{ component.properties.subtitle }}
          </div>
        </div>
        <mat-icon class="listtile-trailing" *ngIf="component.properties?.trailingIcon">
          {{ component.properties.trailingIcon }}
        </mat-icon>
      </div>

      <!-- DEFAULT: Unknown widget type -->
      <div *ngSwitchDefault class="widget-unknown">
        <div class="unknown-content">
          <mat-icon>widgets</mat-icon>
          <span>{{ component.type }}</span>
          <small>Unknown widget type</small>
        </div>
      </div>

    </div>
  </div>
</ng-template>
